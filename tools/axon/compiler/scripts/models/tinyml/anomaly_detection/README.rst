TinyML Anomaly Detection (AD)
=============================

Overview
--------

The **Anomaly Detection** model is designed to identify anomalies in the sounds generated by a machine. This model is based on a **deep autoencoder** architecture. A comprehensive guide is available in the README to help you:

- Download the data
- Train the model
- Convert the model to TFLite
- Test the model using TFLite

For detailed steps, please refer to the guide provided `here <https://github.com/mlcommons/tiny/blob/master/benchmark/training/anomaly_detection/README.md>`_.

The trained anomaly detection model can be downloaded from the following location:
`Anomaly Detection Model <https://github.com/mlcommons/tiny/tree/master/benchmark/training/anomaly_detection/trained_models>`_.

The downloaded tflite or keras model should be placed in the root directory of the model where the compiler input yaml file expects it i.e. *anomaly_detection/<model.tflite> or anomaly_detection/<model.h5>*

Raw Data Set
------------

You can download the raw dataset using the script provided in the repository:
`get_dataset.sh <https://github.com/mlcommons/tiny/blob/master/benchmark/training/anomaly_detection/get_dataset.sh>`_.

Data Pre-Processing
-------------------

Detailed instructions for converting the raw dataset and starting the training process are provided in the README of the model. This includes all necessary steps to prepare your data for training the anomaly detection model.

The output of the Anomaly Detection Model is determined using anomaly scores. The testing of the model is explained in the file `https://github.com/mlcommons/tiny/blob/master/benchmark/training/anomaly_detection/01_test.py`. The model determines the RMS value between the original and predicted values and calculates the anomaly score using that.

The user is guided to go through the implementation of the `01_test.py` script to understand the calculation of the anomaly scores.

Running the Compiler
--------------------

The compiler executor can be run by using the provided example compiler_sample_input file. The compiler sample input expects the tflite model in the root folder of the *anomaly_detection/*.

The user can run the executor by just downloading the tflite file from the location above and using the `compiler_sample_ad_input <compiler_sample_ad_input.yaml>`_ yaml file.

More advanced users who want test accuracy results must download the dataset and uncomment the test_data and test labels fields in the yaml file to be able to use the sample input yaml file.

Once the data is downloaded and the necessary pre-processing steps have been performed on the data, the data files should be placed in the directory : *anomaly_detection/data/*, as expected by the compiler sample input yaml file and must be renamed accordingly. The test data must be renamed *x_test_ad.npy* and the labels *y_test_ad.npy* respectively to match the input yaml file.

If the user decides to reference the test data files from another location, they must update the file location in the yaml file accordingly for the tinyml_ad model.


NOTE
----

- Be sure to go through the README and the Python scripts provided in the repository to fully understand the steps for obtaining the dataset, training the model, and performing pre-processing.
- If you encounter any issues during training or environment setup, refer to the scripts and ensure the correct Python packages are installed.
- Test accuracy results are not available for the Anomaly Detection model as it is not a classification model.
- Only classification models are currently supported for producing test accuracies using Axon.
